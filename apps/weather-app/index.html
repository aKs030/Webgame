<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Weather App</title>
    <meta
      name="description"
      content="Moderne Wetter-App mit aktuellen Wetterdaten und 5-Tage-Vorhersage. Standortbasierte Wetterinformationen."
    />
    <link rel="stylesheet" href="style.css" />
    <!-- Optimized: No External Frameworks -->
    <link rel="stylesheet" href="../../card-integration.css" />
    <script src="../../card-fit.js" defer></script>
  </head>
  <body>
    <div class="weather-container">
      <h1>üå§Ô∏è Weather App</h1>

      <div class="demo-note">
        <strong>Demo-Modus:</strong> Diese App zeigt Beispiel-Wetterdaten. F√ºr
        echte Daten w√§re ein API-Schl√ºssel erforderlich.
      </div>

      <div class="search-section">
        <input
          type="text"
          class="search-input"
          id="cityInput"
          placeholder="Stadt eingeben (z.B. Berlin, M√ºnchen)"
        />
        <button class="search-btn" onclick="searchWeather()">üîç Suchen</button>
        <button class="location-btn" onclick="getCurrentLocation()">
          üìç Standort
        </button>
      </div>

      <div id="weatherContent">
        <div class="loading">
          Gib eine Stadt ein oder nutze deinen Standort f√ºr Wetterdaten
        </div>
      </div>
    </div>

    <script>
      // Demo weather data for different cities
      const demoWeatherData = {
        berlin: {
          location: "Berlin, Deutschland",
          current: {
            temperature: 18,
            description: "Teilweise bew√∂lkt",
            icon: "‚õÖ",
            humidity: 65,
            windSpeed: 12,
            pressure: 1013,
            visibility: 10,
          },
          forecast: [
            { day: "Heute", icon: "‚õÖ", temp: "18¬∞/12¬∞" },
            { day: "Morgen", icon: "üåßÔ∏è", temp: "15¬∞/9¬∞" },
            { day: "√úbermorgen", icon: "‚òÄÔ∏è", temp: "22¬∞/14¬∞" },
            { day: "Donnerstag", icon: "üå§Ô∏è", temp: "20¬∞/13¬∞" },
            { day: "Freitag", icon: "üåßÔ∏è", temp: "16¬∞/10¬∞" },
          ],
        },
        m√ºnchen: {
          location: "M√ºnchen, Deutschland",
          current: {
            temperature: 16,
            description: "Leicht bew√∂lkt",
            icon: "üå§Ô∏è",
            humidity: 58,
            windSpeed: 8,
            pressure: 1018,
            visibility: 12,
          },
          forecast: [
            { day: "Heute", icon: "üå§Ô∏è", temp: "16¬∞/8¬∞" },
            { day: "Morgen", icon: "‚òÄÔ∏è", temp: "19¬∞/11¬∞" },
            { day: "√úbermorgen", icon: "‚õÖ", temp: "17¬∞/9¬∞" },
            { day: "Donnerstag", icon: "üåßÔ∏è", temp: "14¬∞/7¬∞" },
            { day: "Freitag", icon: "‚òÄÔ∏è", temp: "21¬∞/12¬∞" },
          ],
        },
        hamburg: {
          location: "Hamburg, Deutschland",
          current: {
            temperature: 14,
            description: "Regnerisch",
            icon: "üåßÔ∏è",
            humidity: 78,
            windSpeed: 15,
            pressure: 1008,
            visibility: 8,
          },
          forecast: [
            { day: "Heute", icon: "üåßÔ∏è", temp: "14¬∞/10¬∞" },
            { day: "Morgen", icon: "‚õÖ", temp: "16¬∞/11¬∞" },
            { day: "√úbermorgen", icon: "üå§Ô∏è", temp: "18¬∞/12¬∞" },
            { day: "Donnerstag", icon: "‚òÄÔ∏è", temp: "20¬∞/13¬∞" },
            { day: "Freitag", icon: "‚õÖ", temp: "17¬∞/11¬∞" },
          ],
        },
      };

      function searchWeather() {
        const cityInput = document.getElementById("cityInput");
        const city = cityInput.value.trim().toLowerCase();

        if (!city) {
          showError("Bitte gib eine Stadt ein");
          return;
        }

        showLoading();

        // Simulate API delay
        setTimeout(() => {
          const weatherData = demoWeatherData[city];

          if (weatherData) {
            displayWeather(weatherData);
          } else {
            // Generate random weather for unknown cities
            const randomWeather = generateRandomWeather(cityInput.value);
            displayWeather(randomWeather);
          }
        }, 1000);
      }

      function getCurrentLocation() {
        if (navigator.geolocation) {
          showLoading("Standort wird ermittelt...");

          navigator.geolocation.getCurrentPosition(
            (position) => {
              // Simulate getting weather for current location
              setTimeout(() => {
                const locationWeather = {
                  location: "Dein Standort",
                  current: {
                    temperature: Math.floor(Math.random() * 25) + 5,
                    description: "Aktuelles Wetter",
                    icon: getRandomWeatherIcon(),
                    humidity: Math.floor(Math.random() * 40) + 40,
                    windSpeed: Math.floor(Math.random() * 20) + 5,
                    pressure: Math.floor(Math.random() * 50) + 990,
                    visibility: Math.floor(Math.random() * 10) + 5,
                  },
                  forecast: generateRandomForecast(),
                };
                displayWeather(locationWeather);
              }, 1500);
            },
            (error) => {
              showError(
                "Standort konnte nicht ermittelt werden. Versuche es mit einer Stadt.",
              );
            },
          );
        } else {
          showError("Geolocation wird von diesem Browser nicht unterst√ºtzt");
        }
      }

      function generateRandomWeather(cityName) {
        return {
          location: cityName,
          current: {
            temperature: Math.floor(Math.random() * 25) + 5,
            description: getRandomWeatherDescription(),
            icon: getRandomWeatherIcon(),
            humidity: Math.floor(Math.random() * 40) + 40,
            windSpeed: Math.floor(Math.random() * 20) + 5,
            pressure: Math.floor(Math.random() * 50) + 990,
            visibility: Math.floor(Math.random() * 10) + 5,
          },
          forecast: generateRandomForecast(),
        };
      }

      function getRandomWeatherIcon() {
        const icons = ["‚òÄÔ∏è", "‚õÖ", "üå§Ô∏è", "üåßÔ∏è", "‚õàÔ∏è", "üå®Ô∏è", "üå´Ô∏è"];
        return icons[Math.floor(Math.random() * icons.length)];
      }

      function getRandomWeatherDescription() {
        const descriptions = [
          "Sonnig",
          "Teilweise bew√∂lkt",
          "Bew√∂lkt",
          "Leichter Regen",
          "Regnerisch",
          "Gewitter",
          "Neblig",
          "Klar",
        ];
        return descriptions[Math.floor(Math.random() * descriptions.length)];
      }

      function generateRandomForecast() {
        const days = ["Heute", "Morgen", "√úbermorgen", "Donnerstag", "Freitag"];
        return days.map((day) => ({
          day: day,
          icon: getRandomWeatherIcon(),
          temp: `${Math.floor(Math.random() * 15) + 10}¬∞/${Math.floor(Math.random() * 10) + 5}¬∞`,
        }));
      }

      function showLoading(message = "Wetterdaten werden geladen...") {
        document.getElementById("weatherContent").innerHTML = `
                <div class="loading">${message}</div>
            `;
      }

      function showError(message) {
        document.getElementById("weatherContent").innerHTML = `
                <div class="error">${message}</div>
            `;
      }

      function displayWeather(data) {
        const content = `
                <div class="current-weather">
                    <div class="location-name">${data.location}</div>
                    <div class="weather-icon">${data.current.icon}</div>
                    <div class="temperature">${data.current.temperature}¬∞C</div>
                    <div class="weather-description">${data.current.description}</div>
                    
                    <div class="weather-details">
                        <div class="detail-item">
                            <div class="detail-label">Luftfeuchtigkeit</div>
                            <div class="detail-value">${data.current.humidity}%</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Wind</div>
                            <div class="detail-value">${data.current.windSpeed} km/h</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Luftdruck</div>
                            <div class="detail-value">${data.current.pressure} hPa</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Sichtweite</div>
                            <div class="detail-value">${data.current.visibility} km</div>
                        </div>
                    </div>
                </div>
                
                <div class="forecast-section">
                    <div class="forecast-title">5-Tage-Vorhersage</div>
                    <div class="forecast-container">
                        ${data.forecast
                          .map(
                            (item) => `
                            <div class="forecast-item">
                                <div class="forecast-day">${item.day}</div>
                                <div class="forecast-icon">${item.icon}</div>
                                <div class="forecast-temp">${item.temp}</div>
                            </div>
                        `,
                          )
                          .join("")}
                    </div>
                </div>
            `;

        document.getElementById("weatherContent").innerHTML = content;
      }

      // Enter key support
      document
        .getElementById("cityInput")
        .addEventListener("keypress", function (e) {
          if (e.key === "Enter") {
            searchWeather();
          }
        });

      // Load Berlin weather by default
      document.getElementById("cityInput").value = "Berlin";
      searchWeather();
    </script>
  </body>
</html>
